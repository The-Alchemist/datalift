<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
#load("sparql/resources")
#load_core_resources
#if( $describe-uri )
	<title>&lt;$esc.html($describe-uri)&gt; - DataLift</title>
#else
	<title>#i18n("sparql.query.results") - #i18n("sparql.endpoint.title") - DataLift</title>
#end
#css_links
</head>
<body>
#banner
	<div style="position:absolute;top:15px;right:15px;">
		<a href="${baseUri}/sparql" id="goto_sparql" class="button">#i18n("sparql.endpoint.link")</a>
#if( ${securityCtx.userAuthenticated} )
		<a href="${baseUri}/project" id="goto_workspace" class="button">#i18n("project.workspace.link")</a>
	</div>
#end

#set($columnWidth = 100 / $it.columns.size())
	<div id="content" class="ui-widget-content dl-main-panel">
#if( $describe-uri )
	#if( $describe-type == "Graph" )
		#set( $title = "sparql.describe.graph" )
	#elseif( $describe-type == "Predicate" )
		#set( $title = "sparql.describe.predicate" )
	#else
		#set( $title = "sparql.describe.object" )
	#end
#else
	#set( $title = "sparql.query.full" )
#end
		<h3 class="ui-widget-header dl-widget-header">#i18n($title)#if( $describe-uri ) &lt;$esc.html($describe-uri)&gt;#end #if( $min > 0 )#if( $max > 0 )#i18n("results.interval",${min},${max})#else#i18n("results.last",${min})#end#else#if( $max > 0)#i18n("results.first",${max})#end#end</h3>
		<div id="results" class="dl-result-panel">
			<table id="queryresults" style="width:100%">
				<thead>
					<tr>
						<th>#i18n("sparql.subject")</th>
						<th>#i18n("sparql.predicate")</th>
						<th>#i18n("sparql.object")</th>
					</tr>
				</thead>
				<tbody>
#foreach( $item in $it )
					<tr>
#set( $u = $!{item.subject.toString()} )
#if( ${u.startsWith("http://")} || ${u.startsWith("https://")} )
						<td><a href="${baseUri}/sparql/describe?uri=$esc.url($u)&type=Object&default-graph=$!esc.url($repository)">$esc.html($u)</a></td>
#else
						<td>$esc.html($!{item.subject})</td>
#end
#set( $u = $!{item.predicate.toString()} )
#if( ${u.startsWith("http://")} || ${u.startsWith("https://")} )
						<td><a href="${baseUri}/sparql/describe?uri=$esc.url($u)&type=Predicate&default-graph=$!esc.url($repository)">$esc.html($u)</a></td>
#else
						<td>$esc.html($!{item.predicate})</td>
#end
#set( $u = $!{item.object.toString()} )
#if( ${u.startsWith("http://")} || ${u.startsWith("https://")} )
						<td><a href="${baseUri}/sparql/describe?uri=$esc.url($u)&default-graph=$!esc.url($repository)">$esc.html($u)</a></td>
#else
						<td>$esc.html($!{item.object})</td>
#end
					</tr>
#end
				</tbody>
			</table>
			<div id="pagernav"></div>
		</div>
		<div id="searchnav" style="display:none">
			#i18n("grid.search.value.label") <input type="search" id="gridsearch" placeholder="#i18n("grid.search.value.placeholder")" results="0" class="gridsearch" />
			#i18n("grid.search.column.label") <select id="searchColumn">
				<option value="all">#i18n("grid.search.column.option.all")</option>
				<option>#i18n("sparql.subject")</option>
				<option>#i18n("sparql.predicate")</option>
				<option>#i18n("sparql.object")</option>
			</select>
		</div>
	</div>
#footer

#script_links
	<script language="javascript" src="${baseUri}/project/static/js/jqgrid.common.js"></script>
	<script type="text/javascript">
		$(document).ready(function(){
			jQuery.extend(jQuery.jgrid.defaults, getBasicTableParameters());
			$("#goto_sparql").button();
			$("#goto_workspace").button();
			tableToGrid("#queryresults", { datatype: "local" });
			enableTable($("#queryresults"));
			jQuery("#queryresults").trigger("reloadGrid");
		});
	</script>
</body>
</html>
